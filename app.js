(()=>{"use strict";var e={165:function(e,t,o){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=n(o(147)),i=o(187);console.log("        _   _         _           _              _          \n       /\\_\\/\\_\\ _    / /\\        / /\\          /\\ \\         \n      / / / / //\\_\\ / /  \\      / /  \\        /  \\ \\        \n     /\\ \\/ \\ \\/ / // / /\\ \\__  / / /\\ \\__    / /\\ \\ \\       \n    /  \\____\\__/ // / /\\ \\___\\/ / /\\ \\___\\  / / /\\ \\ \\      \n   / /\\/________/ \\ \\ \\ \\/___/\\ \\ \\ \\/___/  \\/_//_\\ \\ \\     \n  / / /\\/_// / /   \\ \\ \\       \\ \\ \\          __\\___ \\ \\    \n / / /    / / /_    \\ \\ \\  _    \\ \\ \\        / /\\   \\ \\ \\   \n/ / /    / / //_/\\__/ / / /_/\\__/ / /       / /_/____\\ \\ \\  \n\\/_/    / / / \\ \\/___/ /  \\ \\/___/ /       /__________\\ \\ \\ \n        \\/_/   \\_____\\/    \\_____\\/        _____________\\/ \n"),console.log("[MSS 3] Powered By SkyWorldStudio"),console.log(`[MSS 3] Version: ${(0,i.getInfo)("version")}`),console.log("[MSS 3] Init Starting");const s="public";r.default.existsSync(s)||(console.log('[MSS 3] Warning! This is the developer version! For users, please refer to wiki. For developers, you can create a "public" folder in the root directory'),process.exit(0));const a=o(326);console.log("[MSS 3] Loading program settings"),(0,a.initUserConfig)();const l=o(95);console.log("[MSS 3] "+(0,l.getMessage)("app.initLang"));const u=n(o(873));u.default.log((0,l.getMessage)("app.initLogger")),u.default.log((0,l.getMessage)("app.initOver"));const _=n(o(37)),f=n(o(406)),d=n(o(511)),c=n(o(97)),p=n(o(685)),g=o(828),S=new f.default;S.keys=[(0,g.v4)()],S.use((0,d.default)({key:(0,g.v4)(),maxAge:864e5,overwrite:!0,httpOnly:!0,signed:!0,rolling:!1,renew:!1,secure:!1},S)),S.use((0,c.default)(s)),S.use((async(e,t)=>{u.default.info(`[HTTP Req] Method: ${e.method} URL: ${e.URL.href}`),u.default.info(`[HTTP Req] IP: ${e.ip} User: ${e.session.userName} UUID: ${e.session.uuid}`),await t()}));const h=p.default.createServer(S.callback()),y=a.userConfig.port,v=a.userConfig.address;if(h.listen(y,v),u.default.info("=----------------------------------------="),u.default.info((0,l.getMessage)("app.Started")),u.default.info((0,l.getMessage)("app.StartedTip")),u.default.info((0,l.getMessage)("app.StartedHost",{port:y})),u.default.info("=----------------------------------------="),"win32"==_.default.platform())try{open(`http://localhost:${y}/`)}catch(e){u.default.warn((0,l.getMessage)("app.Win32WebError"))}},68:function(e,t,o){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=n(o(147)),i=n(o(17));class s{constructor(){r.default.existsSync(s.CONFIG_PATH)||r.default.mkdirSync(s.CONFIG_PATH)}create(e,t,o){const n=i.default.join(s.CONFIG_PATH,e);if(r.default.existsSync(n)||r.default.mkdirSync(n),!this.checkFileName(t))throw new Error("Illegal profile name!");const a=JSON.stringify(o),l=i.default.join(n,t+".json");r.default.writeFileSync(l,a,{encoding:"utf-8"})}get(e,t,o){const n=i.default.join(s.CONFIG_PATH,e);if(r.default.existsSync(n)||r.default.mkdirSync(n),!this.checkFileName(o))throw new Error("Illegal profile name!");const a=i.default.join(n,o+".json");if(!r.default.existsSync(a))return null;const l=r.default.readFileSync(a,{encoding:"utf-8"}),u=JSON.parse(l);return this.JSONToClass(new t,u)}JSONToClass(e,t){for(const o of Object.keys(e)){const n=t[o];void 0!==n&&(n instanceof Object&&"object"==typeof n?this.JSONToClass(e[o],n):e[o]=n)}return e}checkFileName(e){const t=["\\","/",".."];for(const o of t)if(e.includes(o))return!1;return!0}}s.CONFIG_PATH=i.default.join(process.cwd(),"data"),t.default=new s},873:function(e,t,o){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=n(o(94));r.default.configure({appenders:{console:{type:"stdout",layout:{type:"pattern",pattern:"[%d{MM/dd hh:mm:ss}] [%[%p%]] %m"}},logFile:{type:"file",filename:"logs/last.log",layout:{type:"pattern",pattern:"%d %p %m"}}},categories:{default:{appenders:["console","logFile"],level:"info"}}});const i=r.default.getLogger("default");t.default=i},187:function(e,t,o){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getInfo=void 0;const r=n(o(147)),i="package.json";t.getInfo=function(e){if(r.default.existsSync(i)){const t=JSON.parse(r.default.readFileSync(i,{encoding:"utf-8"}));if(t[e])return t[e]}}},95:function(e,t,o){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.i18n=t.getMessage=void 0;const r=n(o(805));t.i18n=r.default;const i=n(o(867)),s=n(o(438));r.default.init({lng:"en_US",fallbackLng:"en_US",resources:{zh_CN:{translation:i.default},en_US:{translation:s.default}}});const a=r.default.t;t.getMessage=a},648:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(){this.language="en_US",this.port=3001,this.address="127.0.0.1"}}},326:function(e,t,o){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.userConfig=t.initUserConfig=void 0;const r=n(o(68)),i=n(o(648)),s=o(95);let a=null;t.userConfig=a,t.initUserConfig=function(){t.userConfig=a=r.default.get("Configs",i.default,"default"),a||(t.userConfig=a=new i.default,r.default.create("Configs","default",a)),a.language&&s.i18n.changeLanguage(a.language)}},805:e=>{e.exports=require("i18next")},406:e=>{e.exports=require("koa")},511:e=>{e.exports=require("koa-session")},97:e=>{e.exports=require("koa-static")},94:e=>{e.exports=require("log4js")},828:e=>{e.exports=require("uuid")},147:e=>{e.exports=require("fs")},685:e=>{e.exports=require("http")},37:e=>{e.exports=require("os")},17:e=>{e.exports=require("path")},438:e=>{e.exports=JSON.parse('{"app":{"initLang":"Internationalization system initialization completed, Language: English","initLogger":"Log system initialization completed","initOver":"Initialization complete","Started":"MSS 3 Panel Service started!","StartedTip":"If you want to exit MSS 3, you can use ctrl+c to terminate the program","StartedHost":"The panel is already in http://localhost:{{port}} starts listening","Win32WebError":"Unable to automatically invoke Windows browser, please try to open the panel manually"}}')},867:e=>{e.exports=JSON.parse('{"app":{"initLang":"国际化系统初始化完成, 语言: 简体中文","initLogger":"日志系统初始化完成","initOver":"初始化完成","Started":"MSS 3 面板服务已启动!","StartedTip":"如果想退出 MSS 3 可以使用 ctrl + c 终止程序","StartedHost":"面板已经在 http://localhost:{{port}} 开始监听","Win32WebError":"无法自动唤起 Windows 浏览器,请尝试手动打开面板"}}')}},t={};!function o(n){var r=t[n];if(void 0!==r)return r.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,o),i.exports}(165)})();